var mfsRequestPrompts=function(e){var t=$(e.target).parents(".mfs"),s=t.find(".mfs-prompts"),a=s.attr("data-prompts-url"),i={search:t.find(".mfs-input").val(),page:s.attr("data-page"),size:s.attr("data-size")};$.ajax({url:a,type:"get",dataType:"json",data:i,context:t,beforeSend:function(){this.find(".mfs-prompts").hide(),this.find(".mfs-input-arrow .caret").hide(),this.find(".mfs-input-arrow .loading").show()}}).done(mfsDisplayPrompts).fail(function(){console.log("error")}).always(function(){this.find(".mfs-prompts").show(),this.find(".mfs-input-arrow .caret").show(),this.find(".mfs-input-arrow .loading").hide()})},mfsDisplayPrompts=function(e){var t=this,s=t.find(".mfs-prompts"),a="";for(var i in e.records){var n=e.records[i].id;a+=t.attr("data-multi-selected")&&t.find(".mfs-multi-selected-display-item[data-key="+n+"]").length?'<li><a class="mfs-multi-selected-item-add mfs-selected" href="'+n+'">'+e.records[i].name+"</a></li>":'<li><a class="mfs-multi-selected-item-add" href="'+n+'">'+e.records[i].name+"</a></li>"}s.find(".mfs-prompts-content").html(a),s.find(".mfs-prompts-pagination").hide();var l=$('<ul class="pagination pagination-sm">'),m=Math.ceil(e.count/s.attr("data-size"));if(m>1){var r=5,d=parseInt(s.attr("data-page"));l.append('<li><a href="1">1</a></li>');for(var i=1,f=Math.ceil(r/2);i<f&&f<r+1;i++)d-i>=1?l.prepend('<li><a href="'+d-i+'">'+d-i+"</a></li>"):f++,d+i<=m?l.append('<li><a href="'+d+i+'">'+d+i+"</a></li>"):f++;l.prepend('<li><a href="1">&laquo;</a></li>').append('<li><a href="'+m+'">&raquo;</a></li>'),s.find(".mfs-prompts-pagination").html(l).show()}},mfsAddMultiSelected=function(e){e.preventDefault();var t=$(e.currentTarget),s=t.parents(".mfs"),a=s.find(".mfs-multi-selected-display-box");0==a.length&&(a=$('<ul class="mfs-multi-selected-display-box"></ul>').appendTo(s));var i=t.attr("href"),n=t.text(),l=s.attr("data-name")+"[]";a.append('<li class="mfs-multi-selected-display-item" data-key="'+i+'">        <span class="mfs-multi-selected-item-name">'+n+'</span>        <a href="#" class="mfs-multi-selected-item-del">Ã—</a>        <input name="'+l+'" type="hidden" value="'+i+'">    </li>'),s.attr("data-multi-selected")&&(e.stopPropagation(),t.addClass("mfs-selected"))},mfsDelMultiSelected=function(e){e.preventDefault();var t=$(e.currentTarget);t.hasClass("mfs-selected")?(e.stopPropagation(),t.parents(".mfs").find(".mfs-multi-selected-display-item[data-key="+t.attr("href")+"]").remove(),t.removeClass("mfs-selected")):t.parents(".mfs-multi-selected-display-item").remove()};jQuery(document).ready(function(e){e(".mfs-input-box").on("click",".mfs-input-arrow",mfsRequestPrompts),e(".mfs-input-box").on("keypress",".mfs-input",mfsRequestPrompts),e(".mfs-input-box").on("focus",".mfs-input",function(t){e(t.currentTarget).val()&&mfsRequestPrompts(t)}),e(document).click(function(t){e(".mfs-prompts").hide()}),e(".mfs-prompts-add, .mfs-prompts-pagination").click(function(e){e.stopPropagation()}),e(".mfs-prompts-content").on("click",".mfs-multi-selected-item-add:not(.mfs-selected)",mfsAddMultiSelected),e(".mfs-prompts-content").on("click",".mfs-selected",mfsDelMultiSelected),e(".mfs").on("click",".mfs-multi-selected-item-del",mfsDelMultiSelected)});