var mfsRequestPrompts=function(t){var e=$(t.target).parents(".mfs"),a=e.find(".mfs-prompts"),s=a.attr("data-prompts-url"),i=1;void 0===a.attr("data-page")?a.attr("data-page",1):i=a.attr("data-page");var n=a.attr("data-size")?a.attr("data-size"):10,m={search:e.find(".mfs-input").val(),page:i,size:n};$.ajax({url:s,type:"get",dataType:"json",data:m,context:e,beforeSend:function(){this.find(".mfs-prompts").hide(),this.find(".mfs-input-arrow .caret").hide(),this.find(".mfs-input-arrow .loading").show()}}).done(mfsDisplayPrompts).fail(function(){console.log("error")}).always(function(){this.find(".mfs-prompts").show(),this.find(".mfs-input-arrow .caret").show(),this.find(".mfs-input-arrow .loading").hide()})},mfsDisplayPrompts=function(t){var e=this,a=e.find(".mfs-prompts"),s=a.attr("data-id-key")?a.attr("data-id-key"):"id",i=a.attr("data-name-key")?a.attr("data-name-key"):"name",n="";for(var m in t.records){var r=t.records[m][s],d=t.records[m][i];n+=e.attr("data-multi-selected")&&e.find(".mfs-multi-selected-display-item[data-key="+r+"]").length?'<li><a class="mfs-selected-item mfs-selected" href="'+r+'">'+d+"</a></li>":'<li><a class="mfs-selected-item" href="'+r+'">'+d+"</a></li>"}a.find(".mfs-prompts-content").html(n),a.find(".mfs-prompts-pagination").hide();var f=$('<ul class="pagination pagination-sm">'),l=Math.ceil(t.count/a.attr("data-size"));if(l>1){var p=5,o=parseInt(a.attr("data-page"));f.append('<li><a href="1">1</a></li>');for(var m=1,c=Math.ceil(p/2);m<c&&c<p+1;m++)o-m>=1?f.prepend('<li><a href="'+o-m+'">'+o-m+"</a></li>"):c++,o+m<=l?f.append('<li><a href="'+o+m+'">'+o+m+"</a></li>"):c++;f.prepend('<li><a href="1">&laquo;</a></li>').append('<li><a href="'+l+'">&raquo;</a></li>'),a.find(".mfs-prompts-pagination").html(f).show()}},mfsSelected=function(t){t.preventDefault();var e=$(t.currentTarget),a=e.parents(".mfs"),s=e.attr("href"),i=e.text(),n=a.attr("data-name"),m=a.find(".mfs-input-box");m.find(".mfs-input").val(i);var r=m.find(".mfs-hidden-input");r.length?r.attr({value:s,name:n}):m.append('<input class="mfs-hidden-input" type="hidden" name="'+n+'" value="'+s+'"/>')},mfsUnselected=function(t){$(t.currentTarget).parents(".mfs").find(".mfs-hidden-input").attr("value","")},mfsAddMultiSelected=function(t){t.preventDefault(),t.stopPropagation();var e=$(t.currentTarget),a=e.parents(".mfs"),s=e.attr("href"),i=e.text(),n=a.find(".mfs-multi-selected-display-box");0==n.length&&(n=$('<ul class="mfs-multi-selected-display-box"></ul>').appendTo(a));var m=a.attr("data-name")+"[]";n.append('<li class="mfs-multi-selected-display-item" data-key="'+s+'">        <span class="mfs-multi-selected-item-name">'+i+'</span>        <a href="#" class="mfs-multi-selected-item-del">Ã—</a>        <input name="'+m+'" type="hidden" value="'+s+'">    </li>'),e.addClass("mfs-selected")},mfsDelMultiSelected=function(t){t.preventDefault();var e=$(t.currentTarget);e.hasClass("mfs-selected")?(t.stopPropagation(),e.parents(".mfs").find(".mfs-multi-selected-display-item[data-key="+e.attr("href")+"]").remove(),e.removeClass("mfs-selected")):e.parents(".mfs-multi-selected-display-item").remove()};jQuery(document).ready(function(t){t(".mfs-input-box").on("click",".mfs-input-arrow",mfsRequestPrompts),t(".mfs-input-box").on("keydown",".mfs-input",mfsRequestPrompts),t(".mfs-input-box").on("focus",".mfs-input",function(e){t(e.currentTarget).val()&&mfsRequestPrompts(e)}),t(document).click(function(e){t(".mfs-prompts").hide()}),t(".mfs-prompts-add, .mfs-prompts-pagination").click(function(t){t.stopPropagation()}),t(".mfs-prompts-pagination").on("click","a",function(e){e.preventDefault();var a=t(e.currentTarget),s=a.attr("href");a.parents(".mfs-prompts").attr("data-page",s),mfsRequestPrompts(e)}),t(".mfs[data-multi-selected] .mfs-prompts-content").on("click",".mfs-selected-item:not(.mfs-selected)",mfsAddMultiSelected),t(".mfs[data-multi-selected] .mfs-prompts-content").on("click",".mfs-selected",mfsDelMultiSelected),t(".mfs[data-multi-selected]").on("click",".mfs-multi-selected-item-del",mfsDelMultiSelected),t(".mfs:not([data-multi-selected]) .mfs-prompts-content").on("click",".mfs-selected-item",mfsSelected),t(".mfs:not([data-multi-selected])").on("keydown",".mfs-input",mfsUnselected)});